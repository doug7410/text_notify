=render 'shared/page_header', title: "Notifications"

.row
  .col-sm-4
    .widget-box
      .widget-header
        %h4.widget-title
          %i.ace-icon.fa.fa-comment
          Send an Individual Text
      .widget-body
        .widget-main.no-padding 
          = bootstrap_form_for @notification, inline_errors: false do |f|
            %fieldset
              = f.alert_message "Please fix the errors below."
              %div
                =f.label :customer_id, "Choose a customer"
                or
                =link_to new_customer_path do
                  create a new one 
                  %i.ace-icon.glyphicon.glyphicon-plus 
                .input-group
                  %span.input-group-addon
                    %i.ace-icon.fa.fa-user
                  = f.select :customer_id, options_for_select(@customers.all.decorate.map {|c| [c.name + " - " +  c.display_phone_number, c.id]}) , hide_label: true
              %hr
              %div
                =f.label :message
                .input-group
                  %span.input-group-addon
                    %i.ace-icon.fa.fa-comment
                  =f.text_field :message, class: "form-control", :placeholder => "the message", hide_label: true
            .form-actions.center
              %button.btn.btn-sm.btn-success{:type => "submit"}
                Send Notification
                %i.ace-icon.fa.fa-arrow-right.icon-on-right.bigger-110
  .col-sm-4
    .widget-box
      .widget-header
        %h4.widget-title
          %i.ace-icon.fa.fa-comment
          Send a Group Text
      .widget-body
        .widget-main.no-padding 
          = bootstrap_form_for @notification, inline_errors: false do |f|
            %fieldset
              = f.alert_message "Please fix the errors below."
              %div
                =f.label :customer_id, "Choose a customer"
                or
                =link_to new_customer_path do
                  create a new one 
                  %i.ace-icon.glyphicon.glyphicon-plus 
                .input-group
                  %span.input-group-addon
                    %i.ace-icon.fa.fa-user
                  = f.select :customer_id, options_for_select(@customers.all.decorate.map {|c| [c.name + " - " +  c.display_phone_number, c.id]}) , hide_label: true
              %hr
              %div
                =f.label :message
                .input-group
                  %span.input-group-addon
                    %i.ace-icon.fa.fa-comment
                  =f.text_field :message, class: "form-control", :placeholder => "the message", hide_label: true
            .form-actions.center
              %button.btn.btn-sm.btn-success{:type => "submit"}
                Send Notification
                %i.ace-icon.fa.fa-arrow-right.icon-on-right.bigger-110
  .col-sm-4
    .widget-box
      .widget-header
        %h4.widget-title
          %i.ace-icon.fa.fa-comment
          Create a New Customer
      .widget-body
        .widget-main.no-padding
          = bootstrap_form_for @customer, inline_errors: false do |f|
            =f.hidden_field :user_id, value: current_user.id
            %fieldset
              = f.alert_message "Please fix the errors below."
              .row
                .col-xs-6
                  = f.label :first_name, "First Name"
                  .input-group
                    %span.input-group-addon
                      %i.ace-icon.fa.fa-user
                    =f.text_field :first_name, class: "form-control", :placeholder => "Jon", hide_label: true
                .col-xs-6
                  = f.label :last_name, "Last Name"
                  .input-group
                    %span.input-group-addon
                      %i.ace-icon.fa.fa-user
                    =f.text_field :last_name, class: "form-control", :placeholder => "Snow", hide_label: true    
              %hr
              .row
                .col-xs-12
                  =f.label :phone_number, "Phone Number"
                  .input-group
                    %span.input-group-addon
                      %i.ace-icon.fa.fa-phone
                    =f.text_field :phone_number, class: "form-control input-mask-phone", hide_label: true
            .form-actions.center
              %button.btn.btn-sm.btn-success{:type => "submit"}
                Create Customer
                %i.ace-icon.fa.fa-arrow-right.icon-on-right.bigger-110              
%hr        
=render 'shared/page_header', title: "Sent Notifications"

%form.form-inline
  Filter By:
  %input.input-medium{:placeholder => "Customer Name", :type => "text"}/
  %input.input-medium{:placeholder => "Phone Number", :type => "text"}/
  date range
  .input-group
    %span.input-group-addon
      %i.fa.fa-calendar.bigger-110
    %input#id-date-range-picker-1.form-control{:name => "date-range-picker", :type => "text"}/
  %label.inline
    %input.ace{:name => "form-field-radio", :type => "radio"}/
    %span.lbl picked up
  %label.inline
    %input.ace{:name => "form-field-radio", :type => "radio"}/
    %span.lbl not picked up
  %label.inline
    %input.ace{:name => "form-field-radio", :type => "radio"}/
    %span.lbl all
  %button.btn.btn-info.btn-sm{:type => "button"}
    %i.ace-icon.fa.bigger-110
    Go
.space-6
%table#sample-table-1.table.table-striped.table-bordered.table-hover
  %thead
    %tr
      %th
        Sent on
        %i.ace-icon.fa.fa-calendar.bigger-110
      %th
        Picked up on 
        %i.ace-icon.fa.fa-calendar.bigger-110
      %th Customer
      %th Phone Number
      %th Message
      %th
  %tbody
    -@notifications.each do |notification|
      %tr
        %td= notification.decorate.sent_date
        %td= notification.item_picked_up_date
        %td
          = link_to notification.customer.decorate.name, customer_path(notification.customer)
        %td= notification.customer.decorate.display_phone_number
        %td= notification.message
        %td
          %button.btn.btn-danger.btn-xs Mark Picked Up
            
%script{:src => "/assets/js/jquery-ui.custom.min.js"}
%script{:src => "/assets/js/jquery.maskedinput.min.js"}
:javascript
  jQuery(function($) {
    $.mask.definitions['~']='[+-]';
    $('.input-mask-phone').mask('(999) 999-9999');
  });